  0%|                                             | 0/1473 [00:00<?, ?it/s]/opt/conda/lib/python3.11/site-packages/torch/utils/checkpoint.py:87: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
                                                                           
{'loss': 0.9307, 'grad_norm': 9.165534973144531, 'learning_rate': 0.0, 'epoch': 0.0}
{'loss': 0.9791, 'grad_norm': 15.55250358581543, 'learning_rate': 4.444444444444445e-06, 'epoch': 0.0}
{'loss': 0.8945, 'grad_norm': 12.687834739685059, 'learning_rate': 8.88888888888889e-06, 'epoch': 0.0}
{'loss': 0.7583, 'grad_norm': 6.6402587890625, 'learning_rate': 1.3333333333333333e-05, 'epoch': 0.0}
{'loss': 0.6644, 'grad_norm': 2.8532097339630127, 'learning_rate': 1.777777777777778e-05, 'epoch': 0.0}
{'loss': 0.8299, 'grad_norm': 4.966635227203369, 'learning_rate': 2.2222222222222223e-05, 'epoch': 0.0}
{'loss': 0.8754, 'grad_norm': 4.385696887969971, 'learning_rate': 2.6666666666666667e-05, 'epoch': 0.0}
{'loss': 0.7046, 'grad_norm': 4.426171779632568, 'learning_rate': 3.111111111111111e-05, 'epoch': 0.01}
{'loss': 0.685, 'grad_norm': 4.557834148406982, 'learning_rate': 3.555555555555556e-05, 'epoch': 0.01}
{'loss': 0.756, 'grad_norm': 4.269037246704102, 'learning_rate': 4e-05, 'epoch': 0.01}
{'loss': 0.6704, 'grad_norm': 5.008464336395264, 'learning_rate': 4.4444444444444447e-05, 'epoch': 0.01}
{'loss': 0.6349, 'grad_norm': 3.9990930557250977, 'learning_rate': 4.888888888888889e-05, 'epoch': 0.01}
{'loss': 0.7069, 'grad_norm': 4.3602447509765625, 'learning_rate': 5.333333333333333e-05, 'epoch': 0.01}
{'loss': 0.6967, 'grad_norm': 4.3887104988098145, 'learning_rate': 5.7777777777777776e-05, 'epoch': 0.01}
{'loss': 0.821, 'grad_norm': 7.251119136810303, 'learning_rate': 6.222222222222222e-05, 'epoch': 0.01}
{'loss': 0.8418, 'grad_norm': 5.020235061645508, 'learning_rate': 6.666666666666667e-05, 'epoch': 0.01}
[2026-02-09 09:46:41,397] [WARNING] [stage3.py:2274:step] 1 pytorch allocator cache flushes since last step. this happens when there is high memory pressure and is detrimental to performance. if this is happening frequently consider adjusting settings to reduce memory consumption. If you are unable to make the cache flushes go away consider adding get_accelerator().empty_cache() calls in your training loop to ensure that all ranks flush their caches at the same time
{'loss': 0.7341, 'grad_norm': 4.635045051574707, 'learning_rate': 7.111111111111112e-05, 'epoch': 0.01}
{'loss': 0.7511, 'grad_norm': 3.501175880432129, 'learning_rate': 7.555555555555556e-05, 'epoch': 0.01}
{'loss': 0.8671, 'grad_norm': 5.296713829040527, 'learning_rate': 8e-05, 'epoch': 0.01}
{'loss': 1.2948, 'grad_norm': 369.1158752441406, 'learning_rate': 8.444444444444444e-05, 'epoch': 0.01}
{'loss': 3.3332, 'grad_norm': 178.71664428710938, 'learning_rate': 8.888888888888889e-05, 'epoch': 0.01}
{'loss': 6.464, 'grad_norm': 1062.3209228515625, 'learning_rate': 9.333333333333334e-05, 'epoch': 0.01}
{'loss': 1.6215, 'grad_norm': 61.86402130126953, 'learning_rate': 9.777777777777778e-05, 'epoch': 0.02}
{'loss': 0.9809, 'grad_norm': 72.09430694580078, 'learning_rate': 0.00010222222222222222, 'epoch': 0.02}
{'loss': 0.7932, 'grad_norm': 16.014408111572266, 'learning_rate': 0.00010666666666666667, 'epoch': 0.02}
{'loss': 0.7865, 'grad_norm': 6.6973161697387695, 'learning_rate': 0.00011111111111111112, 'epoch': 0.02}
{'loss': 0.9628, 'grad_norm': 7.857107162475586, 'learning_rate': 0.00011555555555555555, 'epoch': 0.02}
{'loss': 1.0167, 'grad_norm': 7.0172576904296875, 'learning_rate': 0.00012, 'epoch': 0.02}
{'loss': 0.8872, 'grad_norm': 5.285140514373779, 'learning_rate': 0.00012444444444444444, 'epoch': 0.02}
{'loss': 0.746, 'grad_norm': 7.041224002838135, 'learning_rate': 0.00012888888888888892, 'epoch': 0.02}
{'loss': 0.9873, 'grad_norm': 8.129785537719727, 'learning_rate': 0.00013333333333333334, 'epoch': 0.02}
{'loss': 0.9427, 'grad_norm': 6.745970726013184, 'learning_rate': 0.0001377777777777778, 'epoch': 0.02}
{'loss': 1.0629, 'grad_norm': 7.210692405700684, 'learning_rate': 0.00014222222222222224, 'epoch': 0.02}
{'loss': 0.8055, 'grad_norm': 3.815553903579712, 'learning_rate': 0.00014666666666666666, 'epoch': 0.02}
{'loss': 0.8635, 'grad_norm': 7.317406177520752, 'learning_rate': 0.0001511111111111111, 'epoch': 0.02}
{'loss': 1.0122, 'grad_norm': 5.48986291885376, 'learning_rate': 0.00015555555555555556, 'epoch': 0.02}
{'loss': 1.0121, 'grad_norm': 21.71485137939453, 'learning_rate': 0.00016, 'epoch': 0.03}
{'loss': 4.676, 'grad_norm': 182.378662109375, 'learning_rate': 0.00016444444444444444, 'epoch': 0.03}
{'loss': 0.9848, 'grad_norm': 9.245288848876953, 'learning_rate': 0.00016888888888888889, 'epoch': 0.03}
{'loss': 1.4668, 'grad_norm': 36.257694244384766, 'learning_rate': 0.00017333333333333334, 'epoch': 0.03}
{'loss': 0.9699, 'grad_norm': 19.209779739379883, 'learning_rate': 0.00017777777777777779, 'epoch': 0.03}
{'loss': 2.096, 'grad_norm': 151.85348510742188, 'learning_rate': 0.00018222222222222224, 'epoch': 0.03}
{'loss': 1.2974, 'grad_norm': 30.78466033935547, 'learning_rate': 0.0001866666666666667, 'epoch': 0.03}
{'loss': 2.6969, 'grad_norm': 272.40350341796875, 'learning_rate': 0.00019111111111111114, 'epoch': 0.03}
{'loss': 1.0335, 'grad_norm': 5.204407215118408, 'learning_rate': 0.00019555555555555556, 'epoch': 0.03}
{'loss': 1.0947, 'grad_norm': 13.349878311157227, 'learning_rate': 0.0002, 'epoch': 0.03}
{'loss': 1.22, 'grad_norm': 7.519252777099609, 'learning_rate': 0.0001999997580012294, 'epoch': 0.03}
{'loss': 1.2295, 'grad_norm': 5.378134727478027, 'learning_rate': 0.00019999903200608888, 'epoch': 0.03}
{'loss': 1.0783, 'grad_norm': 19.01325225830078, 'learning_rate': 0.00019999782201809226, 'epoch': 0.03}
{'loss': 1.0323, 'grad_norm': 5.247318744659424, 'learning_rate': 0.0001999961280430958, 'epoch': 0.03}
{'loss': 0.8215, 'grad_norm': 7.71805477142334, 'learning_rate': 0.0001999939500892983, 'epoch': 0.03}
{'loss': 0.8637, 'grad_norm': 5.027664661407471, 'learning_rate': 0.00019999128816724108, 'epoch': 0.04}
{'loss': 0.8493, 'grad_norm': 5.550874710083008, 'learning_rate': 0.0001999881422898077, 'epoch': 0.04}
{'loss': 0.9772, 'grad_norm': 7.362124919891357, 'learning_rate': 0.00019998451247222416, 'epoch': 0.04}
{'loss': 1.0615, 'grad_norm': 5.757965087890625, 'learning_rate': 0.00019998039873205868, 'epoch': 0.04}
{'loss': 0.9557, 'grad_norm': 6.329036712646484, 'learning_rate': 0.00019997580108922165, 'epoch': 0.04}
{'loss': 0.8811, 'grad_norm': 3.7048380374908447, 'learning_rate': 0.0001999707195659656, 'epoch': 0.04}
{'loss': 1.1163, 'grad_norm': 4.242279052734375, 'learning_rate': 0.0001999651541868849, 'epoch': 0.04}
  File "/data1/hbshim/Qwen3-VL/qwen-vl-finetune/qwenvl/train/train_qwen.py", line 206, in <module>
    train()
  File "/data1/hbshim/Qwen3-VL/qwen-vl-finetune/qwenvl/train/train_qwen.py", line 195, in train
    trainer.train()
  File "/opt/conda/lib/python3.11/site-packages/transformers/trainer.py", line 2325, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/transformers/trainer.py", line 2674, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs, num_items_in_batch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/transformers/trainer.py", line 4071, in training_step
    self.accelerator.backward(loss, **kwargs)
  File "/opt/conda/lib/python3.11/site-packages/accelerate/accelerator.py", line 2844, in backward
    self.deepspeed_engine_wrapped.backward(loss, sync_gradients=self.sync_gradients, **kwargs)
  File "/opt/conda/lib/python3.11/site-packages/accelerate/utils/deepspeed.py", line 270, in backward
    self.engine.backward(loss, **kwargs)
  File "/opt/conda/lib/python3.11/site-packages/deepspeed/utils/nvtx.py", line 20, in wrapped_fn
    ret_val = func(*args, **kwargs)
              ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/deepspeed/runtime/engine.py", line 2532, in backward
    loss.backward(**backward_kwargs)
  File "/opt/conda/lib/python3.11/site-packages/torch/_tensor.py", line 581, in backward
    torch.autograd.backward(
  File "/opt/conda/lib/python3.11/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/opt/conda/lib/python3.11/site-packages/torch/autograd/graph.py", line 825, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
[rank0]: Traceback (most recent call last):
[rank0]:   File "/data1/hbshim/Qwen3-VL/qwen-vl-finetune/qwenvl/train/train_qwen.py", line 206, in <module>
[rank0]:     train()
[rank0]:   File "/data1/hbshim/Qwen3-VL/qwen-vl-finetune/qwenvl/train/train_qwen.py", line 195, in train
[rank0]:     trainer.train()
[rank0]:   File "/opt/conda/lib/python3.11/site-packages/transformers/trainer.py", line 2325, in train
[rank0]:     return inner_training_loop(
[rank0]:            ^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/opt/conda/lib/python3.11/site-packages/transformers/trainer.py", line 2674, in _inner_training_loop
[rank0]:     tr_loss_step = self.training_step(model, inputs, num_items_in_batch)
[rank0]:                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/opt/conda/lib/python3.11/site-packages/transformers/trainer.py", line 4071, in training_step
[rank0]:     self.accelerator.backward(loss, **kwargs)
[rank0]:   File "/opt/conda/lib/python3.11/site-packages/accelerate/accelerator.py", line 2844, in backward
[rank0]:     self.deepspeed_engine_wrapped.backward(loss, sync_gradients=self.sync_gradients, **kwargs)
[rank0]:   File "/opt/conda/lib/python3.11/site-packages/accelerate/utils/deepspeed.py", line 270, in backward
[rank0]:     self.engine.backward(loss, **kwargs)
[rank0]:   File "/opt/conda/lib/python3.11/site-packages/deepspeed/utils/nvtx.py", line 20, in wrapped_fn
[rank0]:     ret_val = func(*args, **kwargs)
[rank0]:               ^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/opt/conda/lib/python3.11/site-packages/deepspeed/runtime/engine.py", line 2532, in backward
[rank0]:     loss.backward(**backward_kwargs)
[rank0]:   File "/opt/conda/lib/python3.11/site-packages/torch/_tensor.py", line 581, in backward
[rank0]:     torch.autograd.backward(
[rank0]:   File "/opt/conda/lib/python3.11/site-packages/torch/autograd/__init__.py", line 347, in backward
[rank0]:     _engine_run_backward(
[rank0]:   File "/opt/conda/lib/python3.11/site-packages/torch/autograd/graph.py", line 825, in _engine_run_backward
[rank0]:     return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]: KeyboardInterrupt
